removeStrategy:
  rbac: SYNC
  items: NONE
items:
- kind: backupAndRestore
  name: backup-oc
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  buildersList:
  - backupBuilder:
      subjects:
      - jobConfigurationSubject: {}
      - systemConfigurationSubject:
          omitMasterKey: false
      format:
        tarGzFormat: {}
      exclusive: false
      store:
        s3Store:
          bucketName: backup.cjoc.acaternberg.pscbdemos.com
          sse: true
          bucketFolder: cjoc
          credentialsId: aws-credentials
          region: us-east-1
      retentionPolicy:
        upToNRetentionPolicy:
          n: 2
      safeDelaySeconds: 0
  concurrentBuild: false
  description: ''
  disabled: false
  displayName: backup-oc
- kind: clusterOpProject
  name: backupcontrollers
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  concurrentBuild: true
  description: ''
  disabled: false
  displayName: backupcontrollers
  operations:
  - managedMasterClusterOperation:
      failureMode: IMMEDIATELY
      clusterOpSteps:
      - backupClusterOpStep:
          subjects:
          - jobConfigurationSubject: {}
          - systemConfigurationSubject:
              omitMasterKey: false
          format:
            tarGzFormat: {}
          retentionPolicy:
            noRetentionPolicy: {}
          safeDelaySeconds: 0
          store:
            s3Store:
              bucketName: backup.cjoc.acaternberg.pscbdemos.com
              sse: false
              bucketFolder: controllers
              credentialsId: aws-credentials
              region: us-east-1
      timeoutSeconds: 0
      itemSource:
        parameterItemSource: {}
      inParallel: 0
      noRetries: 0
  parameters:
  - itemParameterDefinition:
      name: controller
      itemSource:
        jenkinsRootItemSource: {}
      filters:
      - isMasterOnlineFilter: {}
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: clusterOpProject
  name: clusterop-test-single-controller
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  concurrentBuild: true
  description: ''
  disabled: false
  displayName: clusterop-test-single-controller
  operations:
  - managedMasterClusterOperation:
      failureMode: IMMEDIATELY
      clusterOpSteps:
      - backupClusterOpStep:
          subjects:
          - jobConfigurationSubject: {}
          - systemConfigurationSubject:
              omitMasterKey: false
          format:
            tarGzFormat: {}
          retentionPolicy:
            noRetentionPolicy: {}
          safeDelaySeconds: 0
          store:
            localFileStore:
              dir: /tmp
      timeoutSeconds: 0
      itemSource:
        connectedMasterWithJenkinsLocation:
          expression: https://cjoc.acaternberg.pscbdemos.com/parentbundle/
      inParallel: 0
      noRetries: 0
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: managedController
  name: controller0
  configuration:
    kubernetes:
      allowExternalAgents: false
      terminationGracePeriodSeconds: 1200
      image: CloudBees CI - Managed Controller - 2.387.1.2
      memory: 3072
      fsGroup: '1000'
      cpus: 1.0
      readinessTimeoutSeconds: 5
      livenessInitialDelaySeconds: 300
      readinessInitialDelaySeconds: 30
      clusterEndpointId: default
      disk: 50
      readinessFailureThreshold: 100
      livenessTimeoutSeconds: 10
      domain: controller0
      livenessPeriodSeconds: 10
      javaOptions: -XshowSettings:vm -XX:+AlwaysPreTouch -XX:+UseG1GC -XX:+DisableExplicitGC
        -XX:+ParallelRefProcEnabled -XX:+UseStringDeduplication -Dhudson.slaves.NodeProvisioner.initialDelay=0
      yaml: ''
  description: ''
  displayName: controller0
  properties:
  - enforceControllerExecutors:
      count: 0
  - configurationAsCode:
      bundle: controller0
  - sharedHeaderLabelOptIn:
      optIn: true
  - healthReporting:
      enabled: true
  - owner:
      delay: 5
      owners: ''
  - envelopeExtension:
      allowExceptions: false
  - sharedConfigurationOptOut:
      optOut: false
- kind: managedController
  name: remotetest
  configuration:
    kubernetes:
      allowExternalAgents: false
      terminationGracePeriodSeconds: 1200
      image: CloudBees CI - Managed Controller - 2.387.1.2
      memory: 3072
      fsGroup: '1000'
      cpus: 1.0
      readinessTimeoutSeconds: 5
      livenessInitialDelaySeconds: 300
      systemProperties: |-
        https.proxyHost=http://45.61.187.67
        https.proxyPort=4000
        http.proxyHost=http://45.61.187.67
        http.proxyPort=4000
        http.nonProxyHosts=localhost|127.0.0.1|10.0.0.0/8|172.16.0.0/12|192.168.0.0/16|*.svc.cluster.local|*.eks.amazonaws.com|*.cloudbees.com|*.jenkins.io|*.pscbdemos.com
      readinessInitialDelaySeconds: 30
      clusterEndpointId: default
      disk: 50
      readinessFailureThreshold: 100
      livenessTimeoutSeconds: 10
      domain: remotetest
      livenessPeriodSeconds: 10
      javaOptions: -XshowSettings:vm -XX:+AlwaysPreTouch -XX:+UseG1GC -XX:+DisableExplicitGC
        -XX:+ParallelRefProcEnabled -XX:+UseStringDeduplication -Dhudson.slaves.NodeProvisioner.initialDelay=0
      yaml: |-
        apiVersion: "networking.k8s.io/v1"
        kind: "Ingress"
        metadata:
          annotations:
            nginx.ingress.kubernetes.io/proxy-body-size: "50m"
            nginx.ingress.kubernetes.io/proxy-request-buffering: "off"
            nginx.ingress.kubernetes.io/ssl-redirect: "true"
            #kubernetes.io/ingress.class: "nginx"
            cert-manager.io/cluster-issuer: letsencrypt
          labels:
            type: "master"
            tenant: "${name}"
            com.cloudbees.pse.type: "master"
            com.cloudbees.cje.type: "master"
            com.cloudbees.pse.tenant: "${name}"
            com.cloudbees.cje.tenant: "${name}"
          name: "${name}"
        spec:
          tls:
            - secretName: tls-secret
              hosts:
                - cjoc.acaternberg.pscbdemos.com
        ---
        apiVersion: "v1"
        kind: "Service"
        metadata:
          annotations:
            prometheus.io/path: /prometheus
            prometheus.io/port: "80"
            prometheus.io/scrape: "true"
          labels:
            app.kubernetes.io/component: Managed-Master
            app.kubernetes.io/instance: ${name}
            app.kubernetes.io/managed-by: CloudBees-Core-Cloud-Operations-Center
            app.kubernetes.io/name: ${name}
        name: "remotetest"
        namespace: "cloudbees-core"
  description: ''
  displayName: remotetest
  properties:
  - configurationAsCode:
      bundle: controller-dev-parent
  - sharedHeaderLabelOptIn:
      optIn: true
  - healthReporting:
      enabled: true
  - owner:
      delay: 5
      owners: ''
  - envelopeExtension:
      allowExceptions: false
  - sharedConfigurationOptOut:
      optOut: false
- kind: folder
  name: Teams
  displayName: Teams
- kind: managedController
  name: testcontroller
  configuration:
    kubernetes:
      allowExternalAgents: false
      terminationGracePeriodSeconds: 1200
      image: CloudBees CI - Managed Controller - 2.387.1.2
      memory: 3072
      fsGroup: '1000'
      cpus: 1.0
      readinessTimeoutSeconds: 5
      livenessInitialDelaySeconds: 300
      readinessInitialDelaySeconds: 30
      clusterEndpointId: default
      disk: 50
      readinessFailureThreshold: 100
      livenessTimeoutSeconds: 10
      domain: testcontroller
      livenessPeriodSeconds: 10
      javaOptions: -XshowSettings:vm -XX:+AlwaysPreTouch -XX:+UseG1GC -XX:+DisableExplicitGC
        -XX:+ParallelRefProcEnabled -XX:+UseStringDeduplication -Dhudson.slaves.NodeProvisioner.initialDelay=0
      yaml: ''
  description: ''
  displayName: testcontroller
  properties:
  - configurationAsCode:
      bundle: controller-dev-child-1
  - sharedHeaderLabelOptIn:
      optIn: true
  - healthReporting:
      enabled: true
  - owner:
      delay: 5
      owners: ''
  - envelopeExtension:
      allowExceptions: false
  - sharedConfigurationOptOut:
      optOut: false
- kind: clusterOpProject
  name: upgrade plugins
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  concurrentBuild: false
  description: ''
  disabled: false
  displayName: upgrade plugins
  operations:
  - managedMasterClusterOperation:
      failureMode: IMMEDIATELY
      clusterOpSteps:
      - refreshUpdateCenterMetadataClusterOpStep: {}
      - upgradePluginsClusterOpStep:
          force: false
      timeoutSeconds: 0
      itemSource:
        parameterItemSource: {}
      inParallel: 0
      noRetries: 0
  parameters:
  - itemParameterDefinition:
      name: controllers
      itemSource:
        jenkinsRootItemSource: {}
      filters:
      - isManagedMasterFilter: {}
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: clusterOpProject
  name: upgradecontroller
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  concurrentBuild: false
  description: ''
  disabled: false
  displayName: upgradecontroller
  operations:
  - managedMasterClusterOperation:
      failureMode: IMMEDIATELY
      clusterOpSteps:
      - updateDockerImageClusterOpStep:
          image: CloudBees CI - Managed Controller - 2.387.1.2
          failOnError: false
      - reprovisionClusterOpStep:
          force: true
          failOnError: false
      timeoutSeconds: 180
      itemSource:
        parameterItemSource: {}
      filters:
      - isMasterOnlineFilter: {}
      inParallel: 0
      noRetries: 0
  parameters:
  - itemParameterDefinition:
      name: controller
      itemSource:
        jenkinsRootItemSource: {}
      filters:
      - isManagedMasterFilter: {}
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: clusterOpProject
  name: upgradeControllers
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  concurrentBuild: true
  description: ''
  disabled: false
  displayName: upgradeControllers
  operations:
  - managedMasterClusterOperation:
      failureMode: IMMEDIATELY
      clusterOpSteps:
      - updateDockerImageClusterOpStep:
          image: CloudBees CI - Managed Controller - 2.387.1.2
          failOnError: false
      timeoutSeconds: 0
      itemSource:
        parameterItemSource: {}
      inParallel: 0
      noRetries: 0
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
