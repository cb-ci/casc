removeStrategy:
  rbac: SYNC
  items: NONE
items:
- kind: freeStyle
  name: Automitisierungsdatenbanken_VBO_aufbauen
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  buildDiscarder:
    logRotator:
      artifactDaysToKeep: -1
      artifactNumToKeep: 5
      daysToKeep: -1
      numToKeep: 20
  builders:
  - singleConditionalBuilder:
      condition:
        neverRun: {}
      buildStep:
        triggerBuilder:
          configs:
          - blockableBuildTriggerConfig:
              configs:
              - predefinedBuildParameters:
                  textParamValueOnNewLine: false
                  properties: DB=$DB
              projects: Drop_schema_type_VBO
              block:
                blockingBehaviour: {}
      runner:
        fail: {}
  - shell:
      command: "#!/usr/bin/ksh -xe\necho Workspace loeschen\nrm -rf $WORKSPACE/*\n\
        \nCVS_USER=Buildmanager\nCVS_USER_PWD=Building1\nCVS_REPO_PATH=/cvsprod\n\
        CVS_REPO_PORT=4502\nCVS_REPO_SERVER=maven2.bvk.int\n\nexport M2_HOME=/opt/seu/sw/apache-maven-3.8.4\n\
        export M2=$M2_HOME/bin\n#export MAVEN_OPTS=\"-Xmx1g -Xms256m -XX:MaxPermSize=312M\"\
        \nexport ORACLE_HOME=/oracle/product/client190\nexport PATH=$M2:$PATH:$ORACLE_HOME/bin\n\
        \n\n\necho team-project-set und build-framework auschecken\ncvs -d :pserver:$CVS_USER@$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH\
        \ checkout -d team-project-set futura4basis/team-project-set\ncvs -d :pserver:$CVS_USER@$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH\
        \ checkout -d build-framework futura4basis/build-framework\n\n\nif [ $AUS_AUSLIEFERUNG\
        \ = true ] ; then\n\tPSF=Auslieferungen/${AUSLIEFERUNG}\nelse\n\tPSF=Release_${RELEASE}/DBAufbau.psf\n\
        fi\n\nmkdir $WORKSPACE/current\necho PSF-Datei auschecken: team-project-set/VBO/$PSF\n\
        \nchmod +x $WORKSPACE/build-framework/buildServer/checkOutTeamProjectSet.sh\n\
        $WORKSPACE/build-framework/buildServer/checkOutTeamProjectSet.sh $CVS_USER\
        \ $CVS_USER_PWD $WORKSPACE/current $WORKSPACE/team-project-set/VBO/$PSF\n\n\
        \n#alle USER und PWD muessen groß sein\ntypeset -u INST\nINST=${INSTANZ}\n\
        \ntypeset -u DB_GROSS\nDB_GROSS=${DB}\n\nexport NLS_LANG=GERMAN_GERMANY.WE8ISO8859P15\n\
        \ncd $WORKSPACE/current/parent-vbo\nmvn clean install -U -P dev -Dmaven.repo.local=~/.m2/repository\n\
        \nmvn tools:setup-all-f4-instance -Ddb.f4.sid=${DB_GROSS} -Ddb.f4.infix=${INST}\
        \ -Dinstance.config.file=$WORKSPACE/current/database-vbo/conf/${DB}_config.sql\
        \ -Dmaven.repo.local=~/.m2/repository\n\n#Pruefen, ob alles erfolgreich durchgelaufen\
        \ sind\nRESULT=`grep -i 'BUILD FAIL$' ${JENKINS_HOME}/jobs/${JOB_NAME}/builds/${BUILD_NUMBER}/log\
        \ | wc -l`\nif [ $RESULT != 0 ]; then\n  echo \"!!!!!   Fehler beim Aufbauen\
        \ des Schemas !!!!!\"\n  exit 1;\nfi\n\n#ERROR=$(grep 'mERROR' ${JENKINS_HOME}/jobs/$JOB_NAME/builds/$BUILD_NUMBER/log\
        \ | wc -l)\n#if [ $ERROR != 0 ]; then\n#echo 'ERROR!'\n#exit 1;\n#fi\n"
  concurrentBuild: false
  description: "Ein Job fuer Aufbauen von einer Datenbank. \r\nRuft maven setup-all-f4-instance\
    \ Goal und baut die Datenbank neu auf. "
  disabled: false
  displayName: Automitisierungsdatenbanken_VBO_aufbauen
  parameters:
  - text:
      trim: false
      defaultValue: vboent12
      name: DB
      description: Datenbank z.B. vboent12
  - text:
      trim: false
      defaultValue: testauto2
      name: INSTANZ
      description: Infix für den setup-all-f4-instance ausgeführt werden soll.
  - text:
      trim: false
      defaultValue: '15.5'
      name: RELEASE
      description: |-
        Für welche Entwicklungslinie soll die DB aufgebaut werden. <br>
        Es wird ein PSF-Datei ausgecheckt, die unter einem Pfad liegt: VBO/Release_[RELEASE]/DBAufbau.psf
  - booleanParam:
      defaultValue: false
      name: AUS_AUSLIEFERUNG
      description: |-
        Wenn true wird nicht das PSF für das Release verwendet (siehe Parameter Release), <br>
        sondern das PSF, das unter AUSLIEFERUNG angegeben wurde. z.B. W-14.6-QB1.psf <br>
  - string:
      trim: false
      name: AUSLIEFERUNG
      description: |
        Wenn AUS_AUSLIEFERUNG true ist und hier ein Wert gesetzt ist, wird nicht das PSF für das Release verwendet (siehe Parameter Release), <br>
        sondern das PSF, das hier angegeben wurde. z.B. W-14.6-QB1.psf <br>
        Es wird ein PSF-Datei ausgecheckt, die unter einem Pfad liegt: VBO/Auslieferungen/[AUSLIEFERUNG]
  publishersList:
  - email-ext:
      configuredTriggers:
      - successTrigger: {}
      matrixTriggerMode: BOTH
      postsendScript: ''
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: freeStyle
  name: BSV-Junit-180
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  buildDiscarder:
    logRotator:
      artifactDaysToKeep: -1
      artifactNumToKeep: 5
      daysToKeep: -1
      numToKeep: 5
  builders:
  - shell:
      command: |-
        echo "----------------------------------------------------------------------------Start-------------------------------------------------------------------------"
        date

        CVS_USER=Buildmanager
        CVS_USER_PWD=Building1
        CVS_REPO_PATH=/cvsprod
        CVS_REPO_PORT=4502
        CVS_REPO_SERVER=maven2.bvk.int
        CVS_REPOURL=$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH

        export CVS_USER CVS_REPOURL CVS_USER_PWD

        rm -rf $WORKSPACE/*
        rm -rf $WORKSPACE/.repository
        #JAVA_OPTS="$JAVA_OPTS -Demma.rt.control.port=$PORT"
        #export JAVA_OPTS

        date
        #echo Auschecken und Bauen
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh
        #chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh

        CVS_TEAMPROJECTSETS_PROJECT=futura4basis/team-project-set

        echo STEP: Team-Project-Sets auschecken
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        cvs -d :pserver:$CVS_USER@$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH checkout -d team-project-set $CVS_TEAMPROJECTSETS_PROJECT
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh

        echo #Code auschecken
        mkdir $WORKSPACE/current
        chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh
        $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh $CVS_USER $CVS_USER_PWD $WORKSPACE/current $WORKSPACE/team-project-set/$CVS_TEAMPROJECTSET
  - maven:
      settings:
        standard: {}
      injectBuildVariables: false
      globalSettings:
        standard: {}
      usePrivateRepository: true
      targets: 'clean install -P junit '
      properties: |-
        dbuser=$JUNIT_USER
        dbpwd=$JUNIT_USER
      pom: current/parent-bsv/pom.xml
  - shell:
      command: |-
        cd $WORKSPACE/current

        #Zert zum Teamscale Server
        #openssl s_client -showcerts -connect sv000330.bvk.int:443 </dev/null 2>/dev/null|openssl x509 -outform PEM > sv000330.bvk.int.pem
        #keytool -importcert -keystore /opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts -storepass changeit -file /seuche/jenkins_prod/sv000330.bvk.int.pem -alias "sv000330.bvk.int"
        /home/tc1/bin/teamscale-upload --trusted-keystore '/opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts;changeit' --server https://sv000330.bvk.int/ --project bsv --user build --accesskey nUmC6Foz1QQJIqq1iqapemJqG7a4ciB4 --partition 'Unit Tests' --format JACOCO --branch-and-timestamp B-BSV-PROD-18_0:HEAD '**/target/site/jacoco/*.xml'
  - maven:
      settings:
        standard: {}
      injectBuildVariables: false
      globalSettings:
        standard: {}
      usePrivateRepository: true
      targets: sonar:sonar -P sonar
      pom: current/parent-bsv/pom.xml
  concurrentBuild: false
  description: ''
  disabled: true
  displayName: BSV-Junit-180
  parameters:
  - string:
      trim: false
      defaultValue: BSV/Release_18.0/junit.psf
      name: CVS_TEAMPROJECTSET
      description: |-
        PSF-Datei die ausgecheckt wird.
        Liste, getrennt durch Leerzeichen
  - string:
      trim: false
      defaultValue: BFW-1_6_1
      name: BFW_VERSION
      description: |-
        Die Version des build-frameworks die verwendet wird, um das auschecken des Workspaces durchführen zu können.
        Es handelt sich hier nur um folgdende Zeile:
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
  - string:
      trim: false
      defaultValue: FUTUNITTEST2_AWK
      name: JUNIT_USER
      description: |-
        Der DB-User für diesen JUnitbuild. <br>
        Die URL für die DB ist in server-junit-bsv/pom.xml hinterlegt.<br>
        Wenn dieser Job kopiert wird, dann muss nur der Teil zwischen FUT und _AWK verändert werden.
  publishersList:
  - jUnitResultArchiver:
      skipPublishingChecks: false
      testResults: current/**/target/surefire-reports/*.xml
      skipOldReports: false
      allowEmptyResults: false
      checksName: ''
      skipMarkingBuildUnstable: false
      healthScaleFactor: 1.0
      keepLongStdio: false
  - email-ext:
      configuredTriggers:
      - failureTrigger: {}
      - fixedTrigger: {}
      - unstableTrigger: {}
      matrixTriggerMode: BOTH
      postsendScript: $DEFAULT_POSTSEND_SCRIPT
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
  triggers:
  - cron:
      spec: '# 30 6-17/2 * * 1-5'
- kind: freeStyle
  name: BSV-Junit-185
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  buildDiscarder:
    logRotator:
      artifactDaysToKeep: -1
      artifactNumToKeep: 20
      daysToKeep: -1
      numToKeep: 20
  builders:
  - shell:
      command: |-
        echo "----------------------------------------------------------------------------Start-------------------------------------------------------------------------"
        date

        CVS_USER=Buildmanager
        CVS_USER_PWD=Building1
        CVS_REPO_PATH=/cvsprod
        CVS_REPO_PORT=4502
        CVS_REPO_SERVER=maven2.bvk.int
        CVS_REPOURL=$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH

        export CVS_USER CVS_REPOURL CVS_USER_PWD

        rm -rf $WORKSPACE/*
        rm -rf $WORKSPACE/.repository
        #JAVA_OPTS="$JAVA_OPTS -Demma.rt.control.port=$PORT"
        #export JAVA_OPTS

        date
        #echo Auschecken und Bauen
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh
        #chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh

        CVS_TEAMPROJECTSETS_PROJECT=futura4basis/team-project-set

        echo STEP: Team-Project-Sets auschecken
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        cvs -d :pserver:$CVS_USER@$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH checkout -d team-project-set $CVS_TEAMPROJECTSETS_PROJECT
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh

        echo #Code auschecken
        mkdir $WORKSPACE/current
        chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh
        $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh $CVS_USER $CVS_USER_PWD $WORKSPACE/current $WORKSPACE/team-project-set/$CVS_TEAMPROJECTSET
  - maven:
      settings:
        standard: {}
      injectBuildVariables: false
      globalSettings:
        standard: {}
      usePrivateRepository: true
      targets: 'clean install -P junit '
      properties: |-
        dbuser=$JUNIT_USER
        dbpwd=$JUNIT_USER
      pom: current/parent-bsv/pom.xml
  - shell:
      command: |-
        cd $WORKSPACE/current

        #Zert zum Teamscale Server
        #openssl s_client -showcerts -connect sv000330.bvk.int:443 </dev/null 2>/dev/null|openssl x509 -outform PEM > sv000330.bvk.int.pem
        #keytool -importcert -keystore /opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts -storepass changeit -file /seuche/jenkins_prod/sv000330.bvk.int.pem -alias "sv000330.bvk.int"
        /home/tc1/bin/teamscale-upload --trusted-keystore '/opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts;changeit' --server https://sv000330.bvk.int/ --project bsv --user build --accesskey nUmC6Foz1QQJIqq1iqapemJqG7a4ciB4 --partition 'Unit Tests' --format JACOCO --branch-and-timestamp B-BSV-PROD-18_6:HEAD '**/target/site/jacoco/*.xml'
  - maven:
      settings:
        standard: {}
      injectBuildVariables: false
      globalSettings:
        standard: {}
      usePrivateRepository: true
      targets: sonar:sonar -P sonar
      pom: current/parent-bsv/pom.xml
  concurrentBuild: false
  description: ''
  disabled: true
  displayName: BSV-Junit-185
  parameters:
  - string:
      trim: false
      defaultValue: BSV/Release_18.5/junit.psf
      name: CVS_TEAMPROJECTSET
      description: |-
        PSF-Datei die ausgecheckt wird.
        Liste, getrennt durch Leerzeichen
  - string:
      trim: false
      defaultValue: BFW-1_6_1
      name: BFW_VERSION
      description: |-
        Die Version des build-frameworks die verwendet wird, um das auschecken des Workspaces durchführen zu können.
        Es handelt sich hier nur um folgdende Zeile:
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
  - string:
      trim: false
      defaultValue: FUTUNITTEST1_AWK
      name: JUNIT_USER
      description: |-
        Der DB-User für diesen JUnitbuild. <br>
        Die URL für die DB ist in server-junit-bsv/pom.xml hinterlegt.<br>
        Wenn dieser Job kopiert wird, dann muss nur der Teil zwischen FUT und _AWK verändert werden.
  publishersList:
  - jUnitResultArchiver:
      skipPublishingChecks: false
      testResults: current/**/target/surefire-reports/*.xml
      skipOldReports: false
      allowEmptyResults: false
      checksName: ''
      skipMarkingBuildUnstable: false
      healthScaleFactor: 1.0
      keepLongStdio: false
  - email-ext:
      configuredTriggers:
      - failureTrigger: {}
      - fixedTrigger: {}
      - unstableTrigger: {}
      matrixTriggerMode: BOTH
      postsendScript: $DEFAULT_POSTSEND_SCRIPT
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
  triggers:
  - cron:
      spec: 30 6-17/2 * * 1-5
- kind: freeStyle
  name: BSV-Junit-190
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  buildDiscarder:
    logRotator:
      artifactDaysToKeep: -1
      artifactNumToKeep: 5
      daysToKeep: -1
      numToKeep: 5
  builders:
  - shell:
      command: |-
        echo "----------------------------------------------------------------------------Start-------------------------------------------------------------------------"
        date

        CVS_USER=Buildmanager
        CVS_USER_PWD=Building1
        CVS_REPO_PATH=/cvsprod
        CVS_REPO_PORT=4502
        CVS_REPO_SERVER=maven2.bvk.int
        CVS_REPOURL=$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH

        export CVS_USER CVS_REPOURL CVS_USER_PWD

        rm -rf $WORKSPACE/*
        rm -rf $WORKSPACE/.repository
        #JAVA_OPTS="$JAVA_OPTS -Demma.rt.control.port=$PORT"
        #export JAVA_OPTS

        date
        #echo Auschecken und Bauen
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh
        #chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh

        CVS_TEAMPROJECTSETS_PROJECT=futura4basis/team-project-set

        echo STEP: Team-Project-Sets auschecken
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        cvs -d :pserver:$CVS_USER@$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH checkout -d team-project-set $CVS_TEAMPROJECTSETS_PROJECT
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh

        echo #Code auschecken
        mkdir $WORKSPACE/current
        chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh
        $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh $CVS_USER $CVS_USER_PWD $WORKSPACE/current $WORKSPACE/team-project-set/$CVS_TEAMPROJECTSET
  - maven:
      settings:
        standard: {}
      injectBuildVariables: false
      globalSettings:
        standard: {}
      usePrivateRepository: true
      targets: 'clean install -P junit '
      properties: |-
        dbuser=$JUNIT_USER
        dbpwd=$JUNIT_USER
      pom: current/parent-bsv/pom.xml
  - shell:
      command: |-
        cd $WORKSPACE/current

        #Zert zum Teamscale Server
        #openssl s_client -showcerts -connect sv000330.bvk.int:443 </dev/null 2>/dev/null|openssl x509 -outform PEM > sv000330.bvk.int.pem
        #keytool -importcert -keystore /opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts -storepass changeit -file /seuche/jenkins_prod/sv000330.bvk.int.pem -alias "sv000330.bvk.int"
        /home/tc1/bin/teamscale-upload --trusted-keystore '/opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts;changeit' --server https://sv000330.bvk.int/ --project bsv --user build --accesskey nUmC6Foz1QQJIqq1iqapemJqG7a4ciB4 --partition 'Unit Tests' --format JACOCO --branch-and-timestamp B-BSV-PROD-19_0:HEAD '**/target/site/jacoco/*.xml'
  - maven:
      settings:
        standard: {}
      injectBuildVariables: false
      globalSettings:
        standard: {}
      usePrivateRepository: true
      targets: sonar:sonar -P sonar
      pom: current/parent-bsv/pom.xml
  concurrentBuild: false
  description: ''
  disabled: true
  displayName: BSV-Junit-190
  parameters:
  - string:
      trim: false
      defaultValue: BSV/Release_19.0/junit.psf
      name: CVS_TEAMPROJECTSET
      description: |-
        PSF-Datei die ausgecheckt wird.
        Liste, getrennt durch Leerzeichen
  - string:
      trim: false
      defaultValue: BFW-1_6_1
      name: BFW_VERSION
      description: |-
        Die Version des build-frameworks die verwendet wird, um das auschecken des Workspaces durchführen zu können.
        Es handelt sich hier nur um folgdende Zeile:
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
  - string:
      trim: false
      defaultValue: FUTUNITTEST3_AWK
      name: JUNIT_USER
      description: |-
        Der DB-User für diesen JUnitbuild. <br>
        Die URL für die DB ist in server-junit-bsv/pom.xml hinterlegt.<br>
        Wenn dieser Job kopiert wird, dann muss nur der Teil zwischen FUT und _AWK verändert werden.
  publishersList:
  - jUnitResultArchiver:
      skipPublishingChecks: false
      testResults: current/**/target/surefire-reports/*.xml
      skipOldReports: false
      allowEmptyResults: false
      checksName: ''
      skipMarkingBuildUnstable: false
      healthScaleFactor: 1.0
      keepLongStdio: false
  - email-ext:
      configuredTriggers:
      - failureTrigger: {}
      - fixedTrigger: {}
      - unstableTrigger: {}
      matrixTriggerMode: BOTH
      postsendScript: $DEFAULT_POSTSEND_SCRIPT
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
  triggers:
  - cron:
      spec: 30 6-17/2 * * 1-5
- kind: freeStyle
  name: ECHO
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  builders:
  - shell:
      command: echo $PATH
  concurrentBuild: false
  description: ''
  disabled: false
  displayName: ECHO
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: freeStyle
  name: TestKopie
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  builders:
  - shell:
      command: |-
        pwd
        echo $JENKINS_HOME
  concurrentBuild: false
  description: Nur ein Test
  disabled: false
  displayName: TestKopie
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: freeStyle
  name: TestVonPatrick
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  builders:
  - shell:
      command: |-
        pwd
        echo $JENKINS_HOME
  concurrentBuild: false
  description: Nur ein Test
  disabled: false
  displayName: TestVonPatrick
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: freeStyle
  name: TestVonPatrick1
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  builders:
  - shell:
      command: |-
        pwd
        echo $JENKINS_HOME
  concurrentBuild: false
  description: Nur ein Test
  disabled: false
  displayName: TestVonPatrick1
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: freeStyle
  name: VBO-NB-KURZTEST
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  buildDiscarder:
    logRotator:
      artifactDaysToKeep: -1
      artifactNumToKeep: 5
      daysToKeep: -1
      numToKeep: 15
  buildWrappers:
  - xvfb:
      installationName: xvfb System Installation
      assignedLabels: ''
      parallelBuild: false
      additionalOptions: ''
      debug: false
      autoDisplayName: false
      displayNameOffset: 1
      screen: ''
      shutdownWithBuild: false
      timeout: 0
  builders:
  - singleConditionalBuilder:
      condition:
        booleanCondition:
          token: $DATENBANK_AUFBAUEN
      buildStep:
        triggerBuilder:
          configs:
          - blockableBuildTriggerConfig:
              configs:
              - predefinedBuildParameters:
                  textParamValueOnNewLine: false
                  properties: |-
                    DB=vboent19
                    INSTANZ=$TOMCAT_INSTANCE
                    RELEASE=$RELEASE
              projects: Automitisierungsdatenbanken_VBO_aufbauen
              block:
                blockingBehaviour: {}
      runner:
        fail: {}
  - singleConditionalBuilder:
      condition:
        booleanCondition:
          token: $DO_AUSCHECKEN
      buildStep:
        shell:
          command: |
            echo "----------------------------------------------------------------------------Start-------------------------------------------------------------------------"
            date

            CVS_USER=Buildmanager
            CVS_USER_PWD=Building1
            CVS_REPO_PATH=/cvsprod
            CVS_REPO_PORT=4502
            CVS_REPO_SERVER=maven2.bvk.int
            CVS_REPOURL=$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH

            export CVS_USER CVS_REPOURL CVS_USER_PWD

            rm -rf $WORKSPACE/*
            rm -rf $WORKSPACE/.repository


            date
            #echo Auschecken und Bauen
            cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh


            CVS_TEAMPROJECTSETS_PROJECT=futura4basis/team-project-set

            echo STEP: Team-Project-Sets auschecken

            cvs -d :pserver:$CVS_USER@$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH checkout -d team-project-set $CVS_TEAMPROJECTSETS_PROJECT
            cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh

            echo #Code auschecken
            mkdir $WORKSPACE/current
            chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh
            $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh $CVS_USER $CVS_USER_PWD $WORKSPACE/current $WORKSPACE/team-project-set/VBO/Release_${RELEASE}/Jenkins/nb.psf
      runner:
        fail: {}
  - shell:
      command: |-
        # Vordem bauen, müssen wir noch manipulieren
        echo STEP: fachmodul.properties anpassen
        cd $WORKSPACE/current/server-$FACHMODUL/rsrc/java
        echo -e "#BES Meldungen Validierung ein- ausschalten\nfutura.bes.validateXML=$BES_VALIDATEXML" >> fachmodul.properties
        sed -i -e 's/$/\r/' fachmodul.properties

        # Als nächstes bauen wir mit Jenkins die Projekte und führen die Unittests durch
  - maven:
      settings:
        mvnSettingsProvider:
          settingsConfigId: ''
      injectBuildVariables: false
      globalSettings:
        mvnGlobalSettingsProvider:
          settingsConfigId: ''
      usePrivateRepository: true
      targets: |-
        clean
        install
        --activate-profiles junit
        -Dlog4j.debug
        --no-transfer-progress
      properties: |-
        JUNIT_SUIT = com.capgemini.futura.server.vbo.test.AllTestsSuite
        FUNCTIONAL_SUIT = functional.AllFunctionalTests
      pom: current/parent-vbo/pom.xml
  - shell:
      command: "# Futura wurde gebaut und die Unittests waren erfolgreich.\n# Jetzt\
        \ machen wir diverse Vorarbeiten, bevor wir den NB starten\n\ncd $WORKSPACE/current/testframework-vbo\n\
        chmod u+x pre-nightlybuild-steps.sh\nbash pre-nightlybuild-steps.sh\necho\
        \ pre-steps completed \n\n\n\n# Wenn die Vorbereitungsschritte erfolgreich\
        \ waren, können wir nun mit Jenkinsfunktion die Testfälle durchführen"
  - singleConditionalBuilder:
      condition:
        booleanCondition:
          token: $TESTS_KUERZEN
      buildStep:
        maven:
          settings:
            mvnSettingsProvider:
              settingsConfigId: ''
          injectBuildVariables: false
          globalSettings:
            mvnGlobalSettingsProvider:
              settingsConfigId: ''
          usePrivateRepository: true
          targets: |-
            clean
            install
            -Dtestfall.names='${DURCHZUFUERENDE_TESTS}'
            -Dteamscale.partition.suffix=Kurztest
            -Dteamscale.branch=VBO-Produktion-17_6
            -Dlog4j.debug
            --no-transfer-progress
          properties: |-
            testskripte.dir=${WORKSPACE}/current/testskripte-vbo/rsrc/test/gevo
            testkette.dir=${WORKSPACE}/current/testskripte-vbo/rsrc/test/testketten
            batchtest.dir=${WORKSPACE}/current/testskripte-vbo/rsrc/test/batch
            printcheck.reference.dir=${WORKSPACE}/current/testskripte-vbo/rsrc/test/printcheck
            sepacheckreference.dir=${WORKSPACE}/current/sepaxmls
            tomcat.port=$TOMCAT_PORT
            jacoco.port=$JACOCO_PORT

            nb.dbinfix=$TOMCAT_INSTANCE
          pom: current/testframework-vbo/pom.xml
      runner:
        fail: {}
  - singleConditionalBuilder:
      condition:
        not:
          condition:
            booleanCondition:
              token: $TESTS_KUERZEN
      buildStep:
        maven:
          settings:
            mvnSettingsProvider:
              settingsConfigId: ''
          injectBuildVariables: false
          globalSettings:
            mvnGlobalSettingsProvider:
              settingsConfigId: ''
          usePrivateRepository: true
          targets: |-
            clean
            install
          properties: |-
            testskripte.dir=${WORKSPACE}/current/testskripte-vbo/rsrc/test/gevo
            testkette.dir=${WORKSPACE}/current/testskripte-vbo/rsrc/test/testketten
            batchtest.dir=${WORKSPACE}/current/testskripte-vbo/rsrc/test/batch
            printcheck.reference.dir=${WORKSPACE}/current/testskripte-vbo/rsrc/test/printcheck
            sepacheckreference.dir=${WORKSPACE}/current/sepaxmls
            tomcat.port=$TOMCAT_PORT
            jacoco.port=$JACOCO_PORT

            nb.dbinfix=$TOMCAT_INSTANCE
          pom: current/testframework-vbo/pom.xml
      runner:
        fail: {}
  - shell:
      command: |
        # Die Tests sind beendet und wir führen nun die Abschlußarbeiten durch
        cd $WORKSPACE/current/testframework-vbo
        chmod u+x post-nightlybuild-steps.sh
        bash post-nightlybuild-steps.sh



        # Damit wir auch einen kompletten Überblick in Sonar haben, führen wir nun noch die Sonarauswertung durch.
  concurrentBuild: false
  description: ''
  disabled: false
  displayName: VBO-NB-KURZTEST
  parameters:
  - string:
      trim: false
      defaultValue: '19.5'
      name: RELEASE
  - string:
      trim: false
      defaultValue: BFW-3_0_0
      name: BFW_VERSION
  - string:
      trim: false
      defaultValue: nb3
      name: TOMCAT_INSTANCE
      description: Tomcat_BASE wird auch als DB-Infix & im Print_Dir verwendet.
  - string:
      trim: false
      defaultValue: vbo
      name: FACHMODUL
      description: Hier muss in Kleinbuchstaben das Fachmodul gepflegt werden.
  - string:
      trim: false
      defaultValue: '10321'
      name: TOMCAT_PORT
      description: |-
        Dies ist der API-Port auf dem der Tomcat auf lnvscint2 hört.
        NB1=10211
        NB2=10221
        NB3=10321
  - string:
      trim: false
      defaultValue: 'on'
      name: BES_VALIDATEXML
      description: Testparameter, ob BES-XML-Dateien validiert werden sollen.
  - string:
      trim: false
      defaultValue: tc2
      name: APP_SERVER_USER
      description: Dies ist der User, mit dem auf den verwendeten Tomcat auf dem entfernten
        Server zugegriffen werden kann.
  - string:
      trim: false
      defaultValue: tomcat
      name: TOMCAT_MANAGER
      description: Der Benutzername für die Manager-WebApp auf dem Tomcat.
  - string:
      trim: false
      defaultValue: '10324'
      name: JACOCO_PORT
      description: |-
        NB1=10214
        NB2=10224
        NB3=10324
  - booleanParam:
      defaultValue: true
      name: DATENBANK_AUFBAUEN
  - booleanParam:
      defaultValue: true
      name: DO_AUSCHECKEN
  - booleanParam:
      defaultValue: true
      name: TESTS_KUERZEN
      description: Kürzt die Tests auf einen GeVo-, Ketten- und Batch-Test.
  - text:
      trim: false
      defaultValue: |-
        GeVoTests:
        TS_GV_VBO_01_001F

        KettenTests:
        TK-I-Vers-050

        BatchTests:
        TS_PR_INX_03_001F_Standard_TF001
      name: DURCHZUFUERENDE_TESTS
  - string:
      trim: false
      defaultValue: FUTNB3_AWK
      name: NB_DB_USER
      description: Dieser User wird benötigt, damit die Unittests, die eine DB brauchen,
        diese auch haben.
  - string:
      trim: false
      defaultValue: /seuche
      name: BASE_DIR
      description: Das Basisverzeichnis, unter dem alle Verzeichnisse für den NB liegen.
  publishersList:
  - jUnitResultArchiver:
      skipPublishingChecks: false
      testResults: current/**/target/failsafe-reports/TEST-*.xml, current/**/target/surefire-reports/*.xml
      skipOldReports: false
      allowEmptyResults: false
      checksName: ''
      skipMarkingBuildUnstable: false
      healthScaleFactor: 1.0
      keepLongStdio: false
  - email-ext:
      configuredTriggers:
      - alwaysTrigger: {}
      matrixTriggerMode: BOTH
      postsendScript: $DEFAULT_POSTSEND_SCRIPT
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
- kind: freeStyle
  name: VBO_JUNIT_190
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  buildDiscarder:
    logRotator:
      artifactDaysToKeep: -1
      artifactNumToKeep: 20
      daysToKeep: -1
      numToKeep: 5
  builders:
  - shell:
      command: |-
        echo "----------------------------------------------------------------------------Start-------------------------------------------------------------------------"
        date

        CVS_USER=Buildmanager
        CVS_USER_PWD=Building1
        CVS_REPO_PATH=/cvsprod
        CVS_REPO_PORT=4502
        CVS_REPO_SERVER=maven2.bvk.int
        CVS_REPOURL=$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH

        export CVS_USER CVS_REPOURL CVS_USER_PWD

        rm -rf $WORKSPACE/*
        rm -rf $WORKSPACE/.repository
        #JAVA_OPTS="$JAVA_OPTS -Demma.rt.control.port=$PORT"
        #export JAVA_OPTS

        date
        #echo Auschecken und Bauen
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh
        #chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh

        CVS_TEAMPROJECTSETS_PROJECT=futura4basis/team-project-set

        echo STEP: Team-Project-Sets auschecken
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        cvs -d :pserver:$CVS_USER@$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH checkout -d team-project-set $CVS_TEAMPROJECTSETS_PROJECT
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh

        echo #Code auschecken
        mkdir $WORKSPACE/current
        chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh
        $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh $CVS_USER $CVS_USER_PWD $WORKSPACE/current $WORKSPACE/team-project-set/$CVS_TEAMPROJECTSET
  - maven:
      settings:
        standard: {}
      injectBuildVariables: false
      globalSettings:
        standard: {}
      usePrivateRepository: true
      targets: |
        clean
        install
        --no-transfer-progress
        --quiet
        --activate-profiles junit
      pom: current/parent-vbo/pom.xml
  - shell:
      command: |-
        cd $WORKSPACE/current

        #Zert zum Teamscale Server
        #openssl s_client -showcerts -connect sv000330.bvk.int:443 </dev/null 2>/dev/null|openssl x509 -outform PEM > sv000330.bvk.int.pem
        #keytool -importcert -keystore /opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts -storepass changeit -file sv000330.bvk.int.pem -alias "sv000330.bvk.int"
        /home/tc1/bin/teamscale-upload --trusted-keystore '/opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts;changeit' --server https://sv000330.bvk.int/ --project vbo --user build --accesskey nUmC6Foz1QQJIqq1iqapemJqG7a4ciB4 --partition 'Unit Tests' --format JACOCO --branch-and-timestamp master:HEAD '**/target/site/jacoco/*.xml'
  concurrentBuild: false
  description: ''
  disabled: true
  displayName: VBO_JUNIT_190
  parameters:
  - string:
      trim: false
      defaultValue: VBO/Release_19.0/junit.psf
      name: CVS_TEAMPROJECTSET
      description: |-
        PSF-Datei die ausgecheckt wird.
        Liste, getrennt durch Leerzeichen
  - string:
      trim: false
      defaultValue: BFW-3_0_0
      name: BFW_VERSION
      description: |-
        Die Version des build-frameworks die verwendet wird, um das Auschecken des Workspaces durchführen zu können.
        Es handelt sich hier nur um folgdende Zeile:
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
  - string:
      trim: false
      defaultValue: com.capgemini.futura.server.vbo.test.AllTestsSuite
      name: JUNIT_SUIT
  publishersList:
  - jUnitResultArchiver:
      skipPublishingChecks: false
      testResults: current/**/target/surefire-reports/*.xml
      skipOldReports: false
      allowEmptyResults: false
      checksName: ''
      skipMarkingBuildUnstable: false
      healthScaleFactor: 1.0
      keepLongStdio: false
  - email-ext:
      configuredTriggers:
      - unstableTrigger: {}
      - secondFailureTrigger: {}
      matrixTriggerMode: BOTH
      postsendScript: $DEFAULT_POSTSEND_SCRIPT
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
  triggers:
  - cron:
      spec: H 6-20/1 * * 1-5
- kind: freeStyle
  name: VBO_JUNIT_195
  JDK:
    name: OracleJDK8Update152
  blockBuildWhenDownstreamBuilding: false
  blockBuildWhenUpstreamBuilding: false
  buildDiscarder:
    logRotator:
      artifactDaysToKeep: -1
      artifactNumToKeep: 20
      daysToKeep: -1
      numToKeep: 5
  builders:
  - shell:
      command: |-
        echo "----------------------------------------------------------------------------Start-------------------------------------------------------------------------"
        date

        CVS_USER=Buildmanager
        CVS_USER_PWD=Building1
        CVS_REPO_PATH=/cvsprod
        CVS_REPO_PORT=4502
        CVS_REPO_SERVER=maven2.bvk.int
        CVS_REPOURL=$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH

        export CVS_USER CVS_REPOURL CVS_USER_PWD

        rm -rf $WORKSPACE/*
        rm -rf $WORKSPACE/.repository
        #JAVA_OPTS="$JAVA_OPTS -Demma.rt.control.port=$PORT"
        #export JAVA_OPTS

        date
        #echo Auschecken und Bauen
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh
        #chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh

        CVS_TEAMPROJECTSETS_PROJECT=futura4basis/team-project-set

        echo STEP: Team-Project-Sets auschecken
        #cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
        cvs -d :pserver:$CVS_USER@$CVS_REPO_SERVER:$CVS_REPO_PORT$CVS_REPO_PATH checkout -d team-project-set $CVS_TEAMPROJECTSETS_PROJECT
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d checkOutSkript futura4basis/build-framework/buildServer/checkOutTeamProjectSet.sh

        echo #Code auschecken
        mkdir $WORKSPACE/current
        chmod +x $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh
        $WORKSPACE/checkOutSkript/checkOutTeamProjectSet.sh $CVS_USER $CVS_USER_PWD $WORKSPACE/current $WORKSPACE/team-project-set/$CVS_TEAMPROJECTSET
  - maven:
      settings:
        standard: {}
      injectBuildVariables: false
      globalSettings:
        standard: {}
      usePrivateRepository: true
      targets: |
        clean
        install
        --no-transfer-progress
        --quiet
        --activate-profiles junit
      pom: current/parent-vbo/pom.xml
  - shell:
      command: |-
        cd $WORKSPACE/current

        #Zert zum Teamscale Server
        #openssl s_client -showcerts -connect sv000330.bvk.int:443 </dev/null 2>/dev/null|openssl x509 -outform PEM > sv000330.bvk.int.pem
        #keytool -delete -v -keystore /opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts -storepass changeit -alias "sv000330.bvk.int"
        #keytool -importcert -v -keystore /opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts -storepass changeit -file sv000330.bvk.int.pem -alias "sv000330.bvk.int"
        /home/tc1/bin/teamscale-upload --trusted-keystore '/opt/seu/sw/jdk1.8.0_152/jre/lib/security/cacerts;changeit' --server https://sv000330.bvk.int/ --project vbo --user build --accesskey nUmC6Foz1QQJIqq1iqapemJqG7a4ciB4 --partition 'Unit Tests' --format JACOCO --branch-and-timestamp master:HEAD '**/target/site/jacoco/*.xml'
  concurrentBuild: false
  description: ''
  disabled: false
  displayName: VBO_JUNIT_195
  parameters:
  - string:
      trim: false
      defaultValue: VBO/Release_19.5/junit.psf
      name: CVS_TEAMPROJECTSET
      description: |-
        PSF-Datei die ausgecheckt wird.
        Liste, getrennt durch Leerzeichen
  - string:
      trim: false
      defaultValue: BFW-3_0_0
      name: BFW_VERSION
      description: |-
        Die Version des build-frameworks die verwendet wird, um das Auschecken des Workspaces durchführen zu können.
        Es handelt sich hier nur um folgdende Zeile:
        cvs -d :pserver:$CVS_USER@$CVS_REPOURL checkout -r $BFW_VERSION -d junit_control futura4basis/build-framework/buildServer/junit_control
  - string:
      trim: false
      defaultValue: com.capgemini.futura.server.vbo.test.AllTestsSuite
      name: JUNIT_SUIT
  publishersList:
  - jUnitResultArchiver:
      skipPublishingChecks: false
      testResults: current/**/target/surefire-reports/*.xml
      skipOldReports: false
      allowEmptyResults: false
      checksName: ''
      skipMarkingBuildUnstable: false
      healthScaleFactor: 1.0
      keepLongStdio: false
  - email-ext:
      configuredTriggers:
      - unstableTrigger: {}
      - secondFailureTrigger: {}
      matrixTriggerMode: BOTH
      postsendScript: $DEFAULT_POSTSEND_SCRIPT
  scm:
    none: {}
  scmCheckoutStrategy:
    standard: {}
  triggers:
  - cron:
      spec: H 6-20/1 * * 1-5
